import streamlit as st
import pandas as pd
import matplotlib.pyplot as plt

# -------------------------------------
# ì•± ì œëª© ë° ì„¤ëª…
# -------------------------------------
st.title("ğŸ  ì œë¡œì—ë„ˆì§€ í•˜ìš°ìŠ¤ ì‹œë®¬ë ˆì´í„°")
st.write("ê°€ì •ì˜ ì—ë„ˆì§€ ì†Œë¹„ë¥¼ ë¶„ì„í•˜ê³ , ë‹¤ì–‘í•œ ì ˆì „ ê¸°ìˆ ì„ ì ìš©í•˜ì—¬ ì „ê¸°ìš”ê¸ˆì„ ì ˆê°í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ì‹œë®¬ë ˆì´ì…˜í•©ë‹ˆë‹¤.")

# -------------------------------------
# ê°€ì „ì œí’ˆ ê¸°ë³¸ ì†Œë¹„ ì „ë ¥ ì‚¬ì „ (W ë‹¨ìœ„)
# -------------------------------------
device_power = {
    "ëƒ‰ì¥ê³ ": 150,
    "ì„¸íƒê¸°": 500,
    "TV": 100,
    "ì—ì–´ì»¨": 1500,
    "ì»´í“¨í„°": 300,
    "ì „ìë ˆì¸ì§€": 1000
}

# -------------------------------------
# ì‚¬ìš©ì ì…ë ¥: ê°€ì „ì œí’ˆ ì„ íƒ ë° ì‚¬ìš© ì‹œê°„
# -------------------------------------
st.subheader("1ï¸âƒ£ ê°€ì „ì œí’ˆ ì‚¬ìš© ì •ë³´ ì…ë ¥")

device = st.selectbox("ì‚¬ìš©í•˜ëŠ” ê°€ì „ì œí’ˆì„ ì„ íƒí•˜ì„¸ìš”:", list(device_power.keys()))
hours_per_day = st.slider("í•˜ë£¨ ì‚¬ìš© ì‹œê°„ (ì‹œê°„ ë‹¨ìœ„)", 0.0, 24.0, 1.0, step=0.5)

# -------------------------------------
# ì ˆì „ ê¸°ìˆ  ì ìš© ì—¬ë¶€ ì„ íƒ
# -------------------------------------
st.subheader("2ï¸âƒ£ ì ˆì „ ê¸°ìˆ  ì ìš© ì—¬ë¶€")

led_lighting = st.checkbox("LED ì¡°ëª… ì‚¬ìš© ì¤‘ì¸ê°€ìš”?", value=False)
inverter_appliance = st.checkbox("ì¸ë²„í„° ëƒ‰ì¥ê³  ì‚¬ìš© ì¤‘ì¸ê°€ìš”?", value=False)

# -------------------------------------
# ì „ê¸°ìš”ê¸ˆ ê³„ì‚°
# -------------------------------------
unit_price = 130  # ì›/kWh

# ê¸°ë³¸ ì†Œë¹„ ì „ë ¥ ë¶ˆëŸ¬ì˜¤ê¸°
power_w = device_power[device]

# ì ˆì „ ê¸°ìˆ  ì ìš©
if led_lighting:
    power_w *= 0.9  # ì†Œë¹„ ì „ë ¥ 10% ì ˆê°
if inverter_appliance:
    power_w *= 0.8  # ì†Œë¹„ ì „ë ¥ 20% ì ˆê°

# W â†’ kW ë‹¨ìœ„ë¡œ ë³€í™˜
power_kw = power_w / 1000

# í•˜ë£¨ ë° í•œ ë‹¬ ì „ë ¥ëŸ‰ ê³„ì‚°
daily_energy = power_kw * hours_per_day
monthly_energy = daily_energy * 30
monthly_cost = monthly_energy * unit_price

# -------------------------------------
# ê²°ê³¼ ì¶œë ¥
# -------------------------------------
st.subheader("ğŸ’° ì˜ˆìƒ ì „ê¸°ìš”ê¸ˆ")

st.write(f"ğŸ“Œ ì „ìì œí’ˆ: **{device}**")
st.write(f"ğŸ”‹ í•˜ë£¨ ì‚¬ìš© ì „ë ¥: **{daily_energy:.2f} kWh**")
st.write(f"ğŸ“… í•œ ë‹¬ ì‚¬ìš© ì „ë ¥: **{monthly_energy:.2f} kWh**")
st.write(f"ğŸ’¸ ì˜ˆìƒ ì „ê¸°ìš”ê¸ˆ: **{monthly_cost:,.0f} ì›**")

# ì ˆì „ ê¸°ìˆ  ì ìš© ë©”ì‹œì§€
if led_lighting or inverter_appliance:
    st.success("âœ… ì ˆì „ ê¸°ìˆ ì´ ì ìš©ë˜ì–´ ì†Œë¹„ ì „ë ¥ì´ ê°ì†Œí–ˆìŠµë‹ˆë‹¤!")

# -------------------------------------
# ê²°ê³¼ ì‹œê°í™”
# -------------------------------------
st.subheader("ğŸ“Š ì „ê¸°ìš”ê¸ˆ ì ˆê° íš¨ê³¼ ì‹œê°í™”")

labels = ['ê¸°ë³¸ ì†Œë¹„ ì „ë ¥', 'ì ˆì „ ê¸°ìˆ  ì ìš© í›„']
sizes = [device_power[device], power_w]
plt.pie(sizes, labels=labels, autopct='%1.1f%%', startangle=90)
plt.axis('equal')  # ì›í˜• ê·¸ë˜í”„ ìœ ì§€
st.pyplot(plt)
